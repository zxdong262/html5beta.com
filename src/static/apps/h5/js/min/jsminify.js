$(function () { $('.options .btn').click(function () { const a = $(this); a.hasClass('btn-primary') ? a.addClass('btn-secondary').removeClass('btn-primary') : a.addClass('btn-primary').removeClass('btn-secondary') }), $('.do').click(function () { const a = $('.t1'); const t = $('.t2'); const r = a.val(); const s = $(this); r && !s.data('working') && (s.data('working', !0).text(s.text() + ' working...'), $.ajax({ type: 'post', url: '/uglify', dataType: 'json', data: { mangle: $('.options [data-opt="mangle"]').hasClass('btn-primary'), seajs: $('.options [data-opt="seajs"]').hasClass('btn-primary'), src: r }, success: function (a) { s.data('working', !1).text(s.text().replace(' working...', '')), $('.post .err').remove(), $('.post').prepend('<div class="pdtb err"></div>'), a.errorMsg ? ht.alert(a.errorMsg, 'warn', $('.err')) : t.val(a.output) } })) }) })
