(function(e){typeof global=="object"&&global&&global.global===global&&(e=global);var t={Converter:function(e){return this.css=e||"",this.output="",this}};t.Converter.prototype=t.prototype={options:{indent:2,cssSyntax:!1,openingBracket:"",closingBracket:"",semicolon:"",eol:"",unPrefix:!1},processCss:function(e){return this.css?(e=e||{},e.indent&&(this.options.indent=e.indent),e.cssSyntax===!0?(this.options.openingBracket="{",this.options.closingBracket="}",this.options.semicolon=":",this.options.eol=";"):e.cssSyntax===!1&&(this.options.openingBracket="",this.options.closingBracket="",this.options.semicolon="",this.options.eol=""),this.options.indent==="tab"?this.indentation=" ":this.indentation=this.repeat(" ",this.options.indent),this.options.unPrefix=e.unPrefix||!1,this.parse(),this):this.css},parse:function(){var e={children:{}},t=this;this.css.replace(/\/\*[\s\S]*?\*\//gm,"").replace(/([^{]+)\{([^}]+)\}/g,function(n,r,i){var s,o,u,a=e,f;t.options.unPrefix&&(i=t.unPrefix(i)),r=t.trim(r);if(/,/.test(r))a=t.addRule(a,r);else{r=r.replace(/\s*([>\+~])\s*/g," &$1").replace(/(\w)([:\.])/g,"$1 &$2"),f=r.split(/[\s]+/);for(s=0,o=f.length;s<o;s++)u=f[s].replace(/&(.)/g,"& $1 ").replace(/& ([:\.]) /g,"&$1"),a=t.addRule(a,u)}i.replace(/([^:;]+):(.+);$/mg,function(e,n,r){a.declarations.push({property:t.trim(n),value:t.trim(r)})})}),this.output=this.generateOutput(e)},unPrefix:function(e){var t={};return e=e.replace(/-\w*-(.*)/g,function(e,n){return t[n]?"":(t[n]=1,n)}).replace(/^(.*)[\s\n]+\1/gm,"$1"),e},addRule:function(e,t){return e.children[t]=e.children[t]||{children:{},declarations:[]}},depth:0,generateOutput:function(e){var t="",n,r,i,s,o,u=this.options.openingBracket?" "+this.options.openingBracket:"";for(n in e.children)if(e.children.hasOwnProperty(n)){t+=this.getIndent()+n+u+"\n",this.depth++,s=e.children[n].declarations;for(r=0,i=s.length;r<i;r++)o=s[r],t+=this.getIndent()+o.property+this.options.semicolon+" "+o.value+this.options.eol+"\n";t+=this.generateOutput(e.children[n]),this.depth--,t+=this.getIndent()+this.options.closingBracket+"\n"+(this.depth===0?"$n":"")}return t=t.replace(/^\s*$[\n\r]{1,}/gm,"").replace(/\$n/g,"\n"),t},getIndent:function(){return this.repeat(this.indentation,this.depth)},getStylus:function(){return this.output},trim:function(e){return e.replace(/\t+/," ").replace(/^\s+|\s+$/g,"")},repeat:function(t,n){return n=e.parseInt(n,10),(new Array(n+1)).join(t)}},e.Css2Stylus=t,typeof module=="object"&&module&&module.exports===exports?module.exports=t:typeof e.define=="function"&&e.define.amd&&e.define("css2stylus",[],function(){return e.Css2Stylus})}).call(this,this)